var fpath = "/Users/mht/Documents/research/polgrice/experiment/data_analysis/data/"

var semData = mht.readCSV(fpath+"literalSemantics.csv").data
var df_semantics = dataFrame(semData, ["state", "judgment"])

var allStates = _.uniq(_.pluck(df_semantics,"state"))
var allUtterances = _.uniq(_.pluck(df_semantics,"utterance"))

var semanticsBDA = function(){
	foreach(allUtterances, function(utt){
		var utteranceData = subset(df_semantics, "utterance", utt)

		foreach(allStates, function(state){
			var theta = uniform(0,1)
			var responses = _.pluck(subset(utteranceData, "state", state), "judgment")

			var scr = sum(map(function(d){return bernoulliERP.score([theta],d==1)}, responses))

			factor(scr)

			query.add([utt, state], theta)

		})
	})

	return query
}

